<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chicken Tycoon</title>
    <link rel="stylesheet" href="style.css?v=2">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
</head>

<body>
    <!-- DEBUG ERROR LOG -->
    <div id="error-log"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 200px; overflow-y: scroll; z-index: 9999; pointer-events: none; color: lime; font-weight: bold; font-family: monospace; font-size: 12px; background: rgba(0,0,0,0.8);">
    </div>
    <script>
        const logDiv = document.getElementById('error-log');
        function logToScreen(msg, color = 'lime') {
            if (logDiv) {
                logDiv.innerHTML += `<div style="color:${color}; border-bottom:1px solid #333;">${msg}</div>`;
                logDiv.scrollTop = logDiv.scrollHeight;
            }
        }

        // Capture Logs
        const oldLog = console.log;
        console.log = function (...args) {
            oldLog.apply(console, args);
            logToScreen(args.join(' '));
        };

        // Capture Errors
        window.onerror = function (msg, url, lineNo, columnNo, error) {
            logToScreen(`ERROR: ${msg} at line ${lineNo}`, 'red');
            return false;
        };
        window.addEventListener('unhandledrejection', function (event) {
            logToScreen(`PROMISE ERROR: ${event.reason}`, 'red');
        });
    </script>
    <div id="game-container">
        <!-- Main Menu Overlay -->
        <div id="main-menu"
            style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000;">
            <h1
                style="font-size: 64px; margin-bottom: 40px; text-shadow: 4px 4px 0px #000; font-family: 'Inter', sans-serif;">
                üêî Chicken Tycoon üêî</h1>

            <button id="btn-new-game" class="menu-btn"
                style="padding: 15px 40px; font-size: 24px; margin: 10px; cursor: pointer; border-radius: 10px; border: none; background: #4caf50; color: white;">New
                Game</button>
            <button id="btn-load-game" class="menu-btn"
                style="padding: 15px 40px; font-size: 24px; margin: 10px; cursor: pointer; border-radius: 10px; border: none; background: #2196f3; color: white;">Continue</button>

            <div style="margin-top: 20px; display: flex; gap: 20px;">
                <button id="btn-export-save" class="menu-btn"
                    style="padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background: #ff9800; color: white;">‚¨áÔ∏è
                    Download Save</button>
                <button id="btn-import-save" class="menu-btn"
                    style="padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background: #9c27b0; color: white;">‚¨ÜÔ∏è
                    Upload Save</button>
            </div>

            <input type="file" id="file-upload" accept=".json" hidden>
            <p style="margin-top: 40px; opacity: 0.6; font-size: 14px; color: cyan;">v46.0 - FORCE RESET</p>
        </div>

        <!-- Canvas will be appended by Three.js or we can target one -->
        <div id="ui-layer">
            <div id="hud">
                <div class="resource-counter">
                    <span class="icon">ü•©</span>
                    <span id="meat-count">0</span>
                </div>
                <div class="resource-counter">
                    <span class="icon">ü™ô</span>
                    <span id="coin-count">0</span>
                </div>
                <button id="btn-hud-save"
                    style="margin-left: 20px; padding: 10px 15px; border-radius: 8px; border: none; background: #2196f3; color: white; cursor: pointer; font-weight: bold; pointer-events: auto;">üíæ
                    Export Save</button>
            </div>

            <div id="upgrade-panel">
                <h2>Upgrades</h2>
                <div class="upgrade-item" id="upgrade-spikes">
                    <div class="info">
                        <h3>Spike Power</h3>
                        <p>Increase damage & speed</p>
                    </div>
                    <button class="buy-btn" data-cost="10">10 ü™ô</button>
                </div>
                <div class="upgrade-item" id="upgrade-spawn">
                    <div class="info">
                        <h3>More Chickens</h3>
                        <p>Increase spawn rate</p>
                    </div>
                    <button class="buy-btn" data-cost="25">25 ü™ô</button>
                </div>
                <div class="upgrade-item" id="upgrade-area">
                    <div class="info">
                        <h3>Expand Area</h3>
                        <p>Unlock new zones</p>
                    </div>
                    <button class="buy-btn" data-cost="1000">1000 ü™ô</button>
                </div>
            </div>
        </div>
    </div>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script type="module" src="src/main.js?v=46"></script>
</body>

</html>